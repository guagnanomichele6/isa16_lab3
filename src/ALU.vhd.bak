LIBRARY ieee;
USE ieee.std_logic_1164.all;
USE ieee.numeric_std.all;

ENTITY ALU IS
	PORT(
		A: IN SIGNED(63 DOWNTO 0);
		B: IN SIGNED(63 DOWNTO 0);
		ALU_OPERATION: IN STD_LOGIC_VECTOR(3 DOWNTO 0);
		ZERO: OUT STD_LOGIC;
		ALU_RESULT: OUT SIGNED(63 DOWNTO 0)
	);
END ENTITY;

ARCHITECTURE BEHAVIOR OF ALU IS

SIGNAL ALU_RESULT_PROV_1,ALU_RESULT_PROV_2,ALU_RESULT_PROV_3,ZERO_SIGN: SIGNED(63 DOWNTO 0);
SIGNAL ZERO_SIGN2: STD_LOGIC;
COMPONENT ADD_SUB IS
        GENERIC(N:INTEGER);
	PORT (
		A 		: IN SIGNED(N-1 DOWNTO 0);
		B 		: IN SIGNED(N-1 DOWNTO 0);
		CIN		: IN STD_LOGIC;
		S 		: OUT SIGNED(N-1 DOWNTO 0)
	);
END COMPONENT;

BEGIN



ADD: ADD_SUB
      GENERIC MAP(64)
      PORT MAP (A,B,ALU_OPERATION(2),ALU_RESULT_PROV_1);

ALU_RESULT_PROV_2<=A AND B;

ALU_RESULT_PROV_3<=A OR B;

WITH ALU_OPERATION SELECT ALU_RESULT <=
	ALU_RESULT_PROV_1 WHEN "0010",--ADD
	ALU_RESULT_PROV_1 WHEN "0110",--SUB
	ALU_RESULT_PROV_2 WHEN "0000",--AND
	ALU_RESULT_PROV_3 WHEN "0001",--OR
	ALU_RESULT_PROV_3 WHEN OTHERS;

ZERO_SIGN<= A XOR B;

WITH ZERO_SIGN SELECT ZERO <=
    '1' WHEN "0000000000000000000000000000000000000000000000000000000000000000",
    '0' WHEN OTHERS;

END ARCHITECTURE;